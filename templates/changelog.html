{% extends 'base.html' %}

{% block title %}
Changelog - QuoteBot
{% endblock %}

{% block head %}
{% endblock %}

{% block content %}
<main style="flex-grow: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 20px;">
    <div style="background: #222937; border-radius: 18px; padding: 40px; padding-right: 80px; padding-left: 80px;width: 80%; margin: 25px 0; display: flex; flex-direction: column; align-items: center;">
        <!-- Title Section -->
        <div style="background: #3A4151; border-radius: 18px; padding-top: 20px; padding-bottom: 20px; padding-left: 50px; padding-right: 50px; text-align: center; width: fit-content;">
            <h2 style="font-size: 2em; font-weight: 700; color: #fff; margin: 0;">Changelog</h2>
        </div>

        <!-- Latest Update Heading -->
        <h3 style="font-size: 1.5em; font-weight: 700; color: #fff; margin-left: -10px; margin-top: 20px; align-self: flex-start;">Latest Update</h3>

        <!-- Latest Update Section -->
        <div style="background: #3A4151; border-radius: 10px; padding: 20px; width: 100%;">
            <h4 style="font-size: 1.2em; font-weight: 700; color: #fff; margin: 0; display: inline;">{{ latest_update.version }}</h4>
            <p style="font-size: 0.6em; font-style: italic; color: #fff; display: inline; margin-left: 5px;">released {{ latest_update.date_added.strftime('%d/%m/%y %H:%M') }}</p>
            <p style="font-size: 1em; font-weight: 400; color: #ffffff; margin-top: 10px;">Feature updates:</p>
            <ul style="list-style: inside; padding-left: 20px; color: #ffffff;">
                {% for item in latest_update.feature_updates %}
                <li>{{ item }}</li>
                {% endfor %}
            </ul>
        </div>
        <hr style="border: 0; height: 1px; background-color: #C0C0C0; margin: 20px 0; width: 100%;">

        <!-- Previous Updates Section -->
        {% for update in past_updates %}
        <div class="update-section" style="background: #3A4151; border-radius: 10px; padding: 15px; width: 100%; position: relative; cursor: pointer; margin-bottom: 10px;">
            <div style="display: flex; align-items: center; justify-content: space-between;">
                <div>
                    <h4 style="font-size: 1.2em; font-weight: 700; color: #fff; margin: 0; display: inline;">{{ update.version }}</h4>
                    <p style="font-size: 0.6em; font-style: italic; color: #fff; display: inline; margin-left: 5px;">released {{ update.date_added.strftime('%d/%m/%y %H:%M') }}</p>
                </div>
                <img src="{{ url_for('static', filename='images/changelog/expand.png') }}" alt="Expand" class="toggle-icon" style="width: 24px; height: 24px;">
            </div>
            <!-- Feature updates will be hidden by default -->
            <div class="feature-updates" style="display: none;">
                <p style="font-size: 1em; font-weight: 400; color: #C0C0C0; margin-top: 10px;">Feature updates:</p>
                <ul style="list-style: inside; padding-left: 20px; color: #C0C0C0;">
                    {% for item in update.feature_updates %}
                    <li>{{ item }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        {% endfor %}
        <script>
            // JavaScript to toggle the feature updates and icons
            document.querySelectorAll('.update-section').forEach(function(section) {
                section.addEventListener('click', function() {
                    var featureUpdates = this.querySelector('.feature-updates');
                    var toggleIcon = this.querySelector('.toggle-icon');
                    var isHidden = featureUpdates.style.display === 'none';
                    
                    featureUpdates.style.display = isHidden ? 'block' : 'none';
                    toggleIcon.src = isHidden ? "{{ url_for('static', filename='images/changelog/collapse.png') }}" : "{{ url_for('static', filename='images/changelog/expand.png') }}";
                });
            });
        </script>

    </div>
</main>
{% endblock %}

{% block scripts %}
<!-- Page-specific scripts -->
{% endblock %}
